<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Specifies the character encoding for the document -->
    <meta charset="UTF-8">
    
    <!-- Ensures the webpage scales properly on different devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Sets the title of the webpage (appears on the browser tab) -->
    <title>MVP Bets</title>
    
    <!-- Embeds JavaScript code for handling form submission and communication with the backend -->
    <script>
        // This function is triggered when the form is submitted
        async function submitForm(event) {
            event.preventDefault(); // Prevents the page from refreshing when the form is submitted

            // Retrieves the selected values from the dropdown menus
            const sport = document.getElementById('sport').value;
            const bet = document.getElementById('bet').value;
            const team1 = document.getElementById('team1').value;
            const team2 = document.getElementById('team2').value;
            
            // Check if the same team is selected for Team 1 and Team 2
            if (team1 == team2) {
                const resultDiv = document.getElementById('result');
                resultDiv.textContent = "Error: You cannot select the same team for both Team 1 and Team 2.";
                resultDiv.style.color = 'red';
                return; // Stop the form submission if validation fails
            }
            
            // Sends a POST request to the backend to process the data
            const response = await fetch('/predict', {
                method: 'POST', // Specifies that the request is a POST request
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded', // Indicates the type of data being sent
                },
                body: `team1=${team1}&team2=${team2}&sport=${sport}&bet=${bet}` // Formats the input data as a URL-encoded string
            });

            // Waits for the response from the backend and parses it as JSON
            const result = await response.json();

            // Selects the result div to display the response
            const resultDiv = document.getElementById('result');

            // If the backend returns an error, display it in red
            if (result.error) {
                resultDiv.textContent = result.error;
                resultDiv.style.color = 'red';
            } 
            else {
                // If successful, display the prediction in green
                resultDiv.textContent = result.prediction;
                resultDiv.style.color = 'green';
            }
        }
    </script>
    <!-- Link to Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <!-- CSS for styling -->
    <style>
        /* Apply the font globally to the body */
        body {
            font-family: 'Roboto', sans-serif; /* Use Roboto with a fallback to a generic sans-serif font */
        }

        /* Example of styling headers differently */
        h3 {
            font-weight: 700; /* Bold font for the header */
        }
        p {
            font-weight: 200;
            font-size: 20px;
        }

        /* Example of styling form elements */
        label, select, button {
            font-family: 'Roboto', sans-serif; /* Ensures consistent font usage for inputs */
            font-size: 16px; /* Adjust font size */
        }
    </style>
</head>
<body>
    <!-- Main heading of the webpage -->
    <h1>MVP Bets</h1>
    <p>
        Welcome to MVP Bets! Use this site as a second opinion in your sports betting! <br><br>
        Please select which sport, bet type, and teams, then click the predict button!<br><br>
        The graph will illustrate the predictions in red.
    </p>
    
    <!-- A form for users to select teams and submit -->
    <form onsubmit="submitForm(event)"> <!-- Triggers the JavaScript function on form submission -->
        <label for="sport">Sport:</label> <!-- Label for Team 1 dropdown -->
        <select id="sport" name="sport" required> <!-- Dropdown menu for Team 1 -->
            <option value="" disabled selected>Select Sport</option> <!-- Default placeholder option -->
            <option value="Basketball">Basketball</option> <!-- Example option -->
            <option value="Football">Football</option>
        </select>

        <label for="bet">Bet Type:</label> <!-- Label for Team 1 dropdown -->
        <select id="bet" name="bet" required> <!-- Dropdown menu for Team 1 -->
            <option value="" disabled selected>Select Bet Type</option> <!-- Default placeholder option -->
            <option value="ML">MoneyLine</option> <!-- Example option -->
            <option value="O/U">Total Over/Under</option>
        </select>
        <br><br>

        <!-- Dropdown for selecting Team 1 -->
        <label for="team1">Team 1:</label> <!-- Label for Team 1 dropdown -->
        <select id="team1" name="team1" required> <!-- Dropdown menu for Team 1 -->
            <option value="" disabled selected>Select Team 1</option>
            {% for team in teams %}
            <option value="{{ team }}">{{ team }}</option>
            {% endfor %}
        </select>
        

        <!-- Dropdown for selecting Team 2 -->
        <label for="team2">Team 2:</label> <!-- Label for Team 2 dropdown -->
        <select id="team2" name="team2" required> <!-- Dropdown menu for Team 2 -->
            <option value="" disabled selected>Select Team 2</option> <!-- Default placeholder option -->
            {% for team in teams %}
            <option value="{{ team }}">{{ team }}</option>
            {% endfor %}
        </select>
        <br><br> <!-- Line breaks for spacing -->

        <!-- Submit button to trigger the form submission -->
        <button type="submit">Predict</button>
    </form>

    <!-- A div to display the result (prediction or error message) -->
    <div id="result" style="margin-top: 20px;"></div> <!-- Adds spacing above the result -->
</body>
</html>
